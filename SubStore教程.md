# Sub-Store 使用教程

> 写给完全不懂的人看的入门指南

---

## 一、Sub-Store 是什么？

**一句话解释**：Sub-Store 是一个「订阅管理中心」，帮你把多个机场订阅合并成一个，并且可以对节点进行筛选、改名、排序等操作。

**打个比方**：
- 你有 3 个外卖 App 的会员，每次点餐要分别打开 3 个 App 查看优惠
- Sub-Store 就像一个「外卖聚合器」，把 3 个 App 的优惠都汇总在一个地方展示
- 而且你还能设置筛选条件，比如"只看满减超过 20 元的"

---

## 二、Sub-Store 能做什么？

| 功能 | 说明 | 实际用途 |
|------|------|---------|
| 🔗 **订阅聚合** | 把多个机场订阅合并成一个链接 | 不用每个机场单独配置 |
| ✂️ **节点筛选** | 用正则表达式筛选想要的节点 | 只保留香港、日本节点 |
| ✏️ **节点改名** | 统一节点命名格式 | 让节点名更清晰易读 |
| 🔄 **节点排序** | 按名称、延迟等排序 | 方便查找和选择 |
| 🗑️ **节点去重** | 删除重复的节点 | 避免列表冗余 |
| ⚡ **缓存加速** | 本地缓存订阅内容 | 减少对机场服务器的请求 |

---

## 三、为什么要用 Sub-Store？

### 场景一：你有多个机场订阅

```
❌ 不用 Sub-Store：
   Stash 里添加 4 个订阅链接
   每个订阅单独更新、单独管理
   节点列表很长很乱

✅ 用 Sub-Store：
   4 个订阅 → 合并成 1 个链接
   Stash 只需添加这 1 个链接
   统一管理、统一格式
```

### 场景二：你只想用部分节点

```
机场给了你 100 个节点，但你只用香港的

❌ 不用 Sub-Store：每次看着 100 个节点头疼
✅ 用 Sub-Store：设置过滤，只保留包含"香港|HK"的节点
```

### 场景三：你想自定义覆写规则

```
你写好了一套分流规则（比如 日港台加美德-stash.yaml）

❌ 直接用机场订阅：无法应用你的规则
✅ 用 Sub-Store：
   1. 聚合所有机场节点
   2. 输出一个纯净的节点链接
   3. 在 Stash 中用覆写配置引用这个链接
```

---

## 四、为什么 Stash/Surge 等 App 内置 Sub-Store？

因为 Sub-Store 是**开源项目**，作者允许其他 App 集成。

对于 App 开发者来说：
- 不用自己写订阅管理功能
- 用户体验更好

对于用户来说：
- 不用单独部署服务
- 打开 App 就能用

---

## 五、你的使用场景

根据你的需求（聚合订阅 + 应用自定义规则），推荐方案：

### 方案：覆写配置 + Sub-Store 聚合节点

```
┌─────────────────────────────────────────────────────────┐
│                      你的工作流                          │
├─────────────────────────────────────────────────────────┤
│                                                         │
│   机场1 ─┐                                              │
│   机场2 ─┼─→ Sub-Store 聚合 ─→ 单一节点链接              │
│   机场3 ─┤                         ↓                    │
│   机场4 ─┘                         ↓                    │
│                                    ↓                    │
│   日港台加美德-stash.yaml ─────→ Stash ←─ 聚合节点链接   │
│   (你的覆写规则)                                        │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 六、实操步骤

### 第一步：打开 Sub-Store

在 Stash 中：`设置` → `Sub-Store`

### 第二步：添加订阅

1. 点击右上角 `+` 添加「单条订阅」
2. 填写：
   - **名称**：随便起，比如 `CNIX`
   - **URL**：粘贴机场给你的订阅链接
3. 点击保存

重复此步骤，添加你所有的机场订阅。

### 第三步：创建组合订阅

1. 切换到「组合订阅」标签
2. 点击 `+` 创建新组合
3. 填写：
   - **名称**：`全部节点` 或你喜欢的名字
   - **包含订阅**：勾选上一步添加的所有订阅
4. 点击保存

### 第四步：获取聚合链接

1. 点击你创建的组合订阅
2. 点击「复制链接」
3. 得到类似这样的链接：
   ```
   http://sub.store/download/全部节点?target=Stash
   ```

### 第五步：在覆写配置中使用

修改你的 `日港台加美德-stash.yaml`，把 `proxy-providers` 改成：

```yaml
proxy-providers:
  全部节点:
    type: http
    url: "http://sub.store/download/全部节点?target=Stash"
    interval: 3600
    path: ./全部节点.yaml
```

然后删除原来的 `Provider-1`、`Provider-2` 等单独的订阅源。

### 第六步：更新并使用

1. 在 Stash 中刷新配置
2. 现在所有节点都聚合在一起了
3. 你的自定义规则也会正常生效

---

## 七、进阶：节点过滤

如果你想只保留特定地区的节点：

在组合订阅设置中，添加「节点操作」：

```yaml
# 只保留香港和日本节点
filter: 香港|HK|Hong|日本|JP|Japan

# 排除包含"过期"的节点
exclude: 过期|剩余|套餐
```

---

## 八、常见问题

### Q: Sub-Store 和直接添加订阅有什么区别？

| 方面 | 直接添加订阅 | 使用 Sub-Store |
|------|-------------|---------------|
| 管理多个机场 | 分散管理 | 统一管理 |
| 节点筛选 | 不支持 | 支持 |
| 节点改名 | 不支持 | 支持 |
| 配合覆写 | 需要写多个 provider | 只需一个 provider |

### Q: Sub-Store 会泄露我的订阅吗？

不会。Sub-Store 在本地运行（或你自己的服务器），订阅信息不会发送给第三方。

### Q: 机场更新节点后，需要手动刷新吗？

不需要。Sub-Store 会按设定的间隔自动刷新（默认 1 小时）。

---

## 九、总结

```
Sub-Store = 订阅聚合器 + 节点处理器

对你来说的价值：
1. 4 个机场订阅 → 1 个聚合链接
2. 覆写配置只需引用 1 个链接
3. 节点自动同步，规则自动生效
4. 再也不用手动合并 YAML 了 ✨
```

---

*最后更新：2026-01-09*
